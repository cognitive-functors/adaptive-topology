# КАК ЭТО РАБОТАЕТ — ПРАКТИЧЕСКИЙ ГАЙД ПО C4-COMPOSER

## ЧТО ЭТО ТАКОЕ

**C4-Enhanced Composer** — это мета-агент, который создаёт команды AI-агентов с **математической гарантией полноты**.

**Простыми словами:**
- Вы говорите: "Хочу систему для лидгена"
- Composer анализирует задачу через призму **27 когнитивных функций** (C4-функторы)
- Создаёт минимальную команду агентов, которая покрывает **все нужные функции**
- Показывает: что покрыто, что упущено, есть ли дубли

**Результат:** вместо "15 агентов наугад" → "6 агентов с 100% покрытием критичных функций"

---

## КАК ЭТО РАБОТАЕТ (end-to-end)

### **ШАГ 1: Пользователь даёт задачу**

```
User: "Создай систему для поиска и квалификации лидов"
```

---

### **ШАГ 2: Composer анализирует через C4 (Phase 1)**

**Что делает Composer внутри:**

```
[Анализ задачи]
Домен: B2B sales, lead generation
Ключевые операции:
 - Поиск лидов (сбор данных) → τ Present, κ (конкретные данные)
 - Квалификация (различение) → δ
 - Проверка истории (прошлое) → τ Past
 - Интеграция в CRM → σ

[Определение нужных функторов]
Базовые:
 1. τ (Past) — проверить, не контактировали ли раньше
 2. τ (Present) — собрать лиды сейчас
 3. δ — квалифицировать (отделить хороших от плохих)
 4. σ — интегрировать в CRM

Coverage: 4/27 = 14.8%
Оценка: достаточно для базовой задачи
```

**Вывод Composer:**
```json
{
 "requiredFunctors": ["τ", "δ", "σ"],
 "modalities": {"τ": ["Past", "Present"]},
 "coverageNeeded": 14.8
}
```

---

### **ШАГ 3: Composer подбирает агентов (Phase 2)**

**Что делает:**

Смотрит на список доступных агентов с их C4-тегами:

```
Available agents:
 • history_checker@domain [c4Functor: "τ", modality: "Past"]
 • lead_scraper@domain [c4Functor: "τ", modality: "Present"]
 • qualifier@domain [c4Functor: "δ"]
 • crm_integrator@domain [c4Functor: "σ"]
 • pattern_analyzer@domain [c4Functor: "ρ"] ← не нужен для этой задачи
 • scheduler@domain [c4Functor: "τ", modality: "Future"] ← не нужен
```

**Результат matching:**
```
 τ Past → history_checker
 τ Present → lead_scraper
 δ → qualifier
 σ → crm_integrator

Gaps: нет
Redundancy: нет
```

---

### **ШАГ 4: Composer создаёт Map JSON (Phase 3)**

**Структура workflow:**

```
[Node 1: history_checker] → [Node 2: lead_scraper] → [Node 3: qualifier] → [Node 4: crm_integrator]
 τ Past τ Present δ σ
```

**JSON (упрощённо):**
```json
{
 "title": "leadgen-basic-system",
 "c4Coverage": {
 "baseFunctors": ["τ", "δ", "σ"],
 "totalFunctors": 4,
 "coveragePercent": 14.8,
 "missingCritical": [],
 "redundant": []
 },
 "flow": {
 "nodes": [
 {
 "id": "n1",
 "data": {
 "uname": "history_check",
 "text": "Check: was this lead contacted before?",
 "c4Functor": "τ",
 "c4Modality": "Past"
 }
 },
 {
 "id": "n2",
 "data": {
 "uname": "scrape_leads",
 "text": "Scrape 50 leads from LinkedIn",
 "c4Functor": "τ",
 "c4Modality": "Present"
 }
 },
 {
 "id": "n3",
 "data": {
 "uname": "qualify",
 "text": "Score each lead 0-100, keep > 70",
 "c4Functor": "δ"
 }
 },
 {
 "id": "n4",
 "data": {
 "uname": "crm_add",
 "text": "Add qualified leads to CRM",
 "c4Functor": "σ"
 }
 }
 ],
 "edges": [
 {
 "source": "n1",
 "target": "n2",
 "data": {
 "recipient": "history_checker@domain",
 "c4Functor": "τ",
 "sequence": 1
 }
 },
 // ... остальные edges
 ]
 }
}
```

---

### **ШАГ 5: Валидация (Phase 4-5)**

**Composer проверяет:**

 **Coverage check:** все критичные функторы покрыты? → ДА
 **Redundancy check:** есть дубли? → НЕТ
 **Sequence check:** порядок логичный? → ДА (τ Past → τ Present → δ → σ)
 **Composition check:** нужны ли композиции? → НЕТ (простая задача)

**Результат:** готовый JSON отправляется пользователю.

---

### **ШАГ 6: Пользователь видит результат**

**UI показывает:**

```
┌─────────────────────────────────────────────────────────┐
│ Workflow: leadgen-basic-system │
├─────────────────────────────────────────────────────────┤
│ C4 COVERAGE: 14.8% (4/27 functors) │
│ │
│ Functors used: │
│ • τ Past — Check history │
│ • τ Present — Collect leads now │
│ • δ — Qualify (differentiate) │
│ • σ — Integrate into CRM │
│ │
│ All critical functors covered │
│ No redundancy │
│ Optimal sequence (Past → Present → Qualify → CRM) │
│ │
│ Optional enhancements: │
│ • Add ρ (pattern detection) for conversion analysis │
│ • Add τ Future (scheduler) for follow-ups │
└─────────────────────────────────────────────────────────┘
```

**Визуализация workflow:**

```
┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│ τ Past │────│ τ Present │────│ δ │────│ σ │
│ History │ │ Scraper │ │ Qualifier │ │ CRM │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘
```

---

## КАК COMPOSER ПРИНИМАЕТ РЕШЕНИЯ

### **Алгоритм выбора функторов**

```
┌─────────────────────────────────────────────────────────┐
│ ВХОДНЫЕ ДАННЫЕ: │
│ - User goal: "Create leadgen system" │
│ - Available agents: 10 штук с c4Functor тегами │
└─────────────────────────────────────────────────────────┘
 ↓
┌─────────────────────────────────────────────────────────┐
│ ЭТАП 1: ИЗВЛЕЧЕНИЕ КЛЮЧЕВЫХ СЛОВ │
│ "leadgen" → сбор данных, квалификация │
│ "system" → интеграция, процесс │
└─────────────────────────────────────────────────────────┘
 ↓
┌─────────────────────────────────────────────────────────┐
│ ЭТАП 2: МАППИНГ НА КОГНИТИВНЫЕ ОПЕРАЦИИ │
│ • Сбор данных → τ (Present) + κ (конкретика) │
│ • Квалификация → δ (различение) │
│ • Проверка истории → τ (Past) │
│ • Интеграция → σ │
└─────────────────────────────────────────────────────────┘
 ↓
┌─────────────────────────────────────────────────────────┐
│ ЭТАП 3: ПРИОРИТИЗАЦИЯ │
│ Критичные: τ Past (избежать дублей), τ Present, δ, σ │
│ Опциональные: ρ (паттерны), τ Future (планирование) │
└─────────────────────────────────────────────────────────┘
 ↓
┌─────────────────────────────────────────────────────────┐
│ ЭТАП 4: ПОДБОР АГЕНТОВ │
│ τ Past → history_checker │
│ τ Present → lead_scraper │
│ δ → qualifier │
│ σ → crm_integrator │
└─────────────────────────────────────────────────────────┘
 ↓
┌─────────────────────────────────────────────────────────┐
│ ВЫХОД: Map JSON + c4Coverage metadata │
└─────────────────────────────────────────────────────────┘
```

---

## ПРИМЕРЫ ПО СЛОЖНОСТИ

### **ПРИМЕР 1: ПРОСТАЯ ЗАДАЧА (5-7 функторов, 18-26% coverage)**

**User request:**
```
"Найди 100 лидов в fintech и добавь в CRM"
```

**C4 Analysis:**
```
Операции:
 1. Сбор лидов → τ Present
 2. Фильтрация по критериям → δ
 3. Добавление в CRM → σ

Функторы: 3
Coverage: 11%
Команда: 3 агента
```

**Результат:**
```
Workflow:
 [Scraper] → [Filter] → [CRM]
 τ° δ σ

Время создания: 10 секунд
Агентов: 3 (минимум)
```

---

### **ПРИМЕР 2: СРЕДНЯЯ ЗАДАЧА (8-12 функторов, 30-44% coverage)**

**User request:**
```
"Создай систему лидгена с автоматическим outreach и анализом результатов"
```

**C4 Analysis:**
```
Операции:
 1. Проверка истории → τ Past
 2. Сбор лидов → τ Present
 3. Квалификация → δ
 4. Адаптация сообщений → φ (контекст)
 5. Планирование касаний → τ Future
 6. Интеграция в CRM → σ
 7. Анализ паттернов → ρ
 8. Прогноз эффективности → τ∘ρ (композиция!)

Функторы: 8 (7 базовых + 1 композиция)
Coverage: 30%
Команда: 8 агентов
```

**Результат:**
```
Main flow:
 [History] → [Scraper] → [Qualifier] → [Adapter] → [Scheduler] → [CRM]
 τ⁻ τ⁰ δ φ τ⁺ σ
 ↓
Parallel branch: [Analyzer] → [Forecaster]
 ρ τ∘ρ

Время создания: 15 секунд
Агентов: 8 (оптимизировано)
Композиции: 1 (τ∘ρ для прогноза)
```

---

### **ПРИМЕР 3: СЛОЖНАЯ ЗАДАЧА (13-18 функторов, 48-67% coverage)**

**User request:**
```
"Построй полную систему продаж: от лидгена до закрытия сделки,
с анализом причин отказов, оптимизацией процесса и обучением агентов"
```

**C4 Analysis:**
```
Операции:
 BASE:
 1. τ Past — история клиента
 2. τ Present — текущий сбор
 3. τ Future — планирование
 4. δ — квалификация, сегментация
 5. ρ — паттерны конверсии/отказов
 6. σ — интеграция данных
 7. φ — адаптация под контекст
 8. μ — рефлексия процесса
 9. ι — альтернативные подходы

 COMPOSITIONS:
 10. τ∘ρ — прогноз трендов
 11. δ∘ι — multi-stakeholder анализ (клиент vs. компания)
 12. ρ∘φ — адаптивные паттерны
 13. μ∘φ — оптимизация процесса
 14. λ∘σ — построение общей теории продаж
 15. σ∘ι — синтез противоречий (скорость vs. качество)

Функторы: 15 (9 базовых + 6 композиций)
Coverage: 56%
Команда: 15-17 агентов
```

**Результат:**
```
Main pipeline:
 [History] → [Scraper] → [Qualifier] → [Adapter] → [Scheduler] → [CRM] → [Closer]
 τ⁻ τ⁰ δ φ τ⁺ σ σ

Analysis layer (parallel):
 [Pattern Detector] → [Forecaster] → [Adaptive Engine]
 ρ τ∘ρ ρ∘φ

Optimization layer (feedback):
 [Process Reflector] → [Optimizer] → [Theory Builder]
 μ μ∘φ λ∘σ

Alternative strategies:
 [Invertor] → [Dialectician]
 ι σ∘ι

Время создания: 30 секунд
Агентов: 17 (полная система)
Композиций: 6
Feedback loops: 2
```

---

## КАК ЧИТАТЬ C4 COVERAGE

### **Структура c4Coverage (что означает каждое поле):**

```json
{
 "c4Coverage": {
 "baseFunctors": ["τ", "δ", "ρ", "σ", "φ"],
 // ↑ Какие базовые функторы используются (из 9)

 "baseFunctorModalities": {
 "τ": ["Past", "Present", "Future"]
 },
 // ↑ Для τ: какие временные модальности задействованы

 "compositions": ["τ∘ρ", "ρ∘φ", "μ∘φ"],
 // ↑ Какие композиции используются (из 18)

 "totalFunctors": 10,
 // ↑ Общее количество уникальных функторов

 "coveragePercent": 37.0,
 // ↑ Процент покрытия (10/27 = 37%)

 "missingCritical": [],
 // ↑ Критичные функторы, которых НЕ ХВАТАЕТ
 // Если не пусто → WARNING!

 "missingOptional": ["ι∘λ", "λ∘σ"],
 // ↑ Опциональные функторы (могут улучшить, но не обязательны)

 "redundant": [],
 // ↑ Дубли (два агента с одним функтором)
 // Если не пусто → WASTE!

 "sequenceWarnings": [],
 // ↑ Предупреждения о неестественном порядке
 // Пример: "τ⁺ before τ⁻ (planning before history)"

 "compositionImplementation": {
 "τ∘ρ": "Dedicated agent (trend_forecaster@domain)",
 "ρ∘φ": "Chained (pattern_analyzer → message_adapter)",
 "μ∘φ": "Feedback loop (optimizer → all agents)"
 },
 // ↑ КАК реализованы композиции

 "analysisNotes": "Full adaptive system. Optional: add ι∘λ for ICP challenge."
 // ↑ Комментарии Composer
 }
}
```

---

## ИНТЕРПРЕТАЦИЯ COVERAGE

### **По проценту покрытия:**

```
┌──────────────────────────────────────────────────────────┐
│ 0-15% │ МИНИМАЛЬНАЯ СИСТЕМА │
│ │ Подходит для: простые задачи (1-2 операции) │
│ │ Пример: "Собрать лиды и положить в CRM" │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│ 15-30% │ БАЗОВАЯ СИСТЕМА │
│ │ Подходит для: типовые процессы │
│ │ Пример: "Лидген + квалификация + outreach" │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│ 30-50% │ ПРОДВИНУТАЯ СИСТЕМА │
│ │ Подходит для: комплексные задачи с адаптацией │
│ │ Пример: "Лидген + анализ + оптимизация" │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│ 50-70% │ КОМПЛЕКСНАЯ СИСТЕМА │
│ │ Подходит для: стратегические задачи │
│ │ Пример: "Полный цикл продаж + обучение" │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│ 70-100% │ УНИВЕРСАЛЬНАЯ СИСТЕМА (AGI-уровень) │
│ │ Подходит для: открытые проблемы │
│ │ Пример: "Построить стратегию компании с нуля" │
└──────────────────────────────────────────────────────────┘
```

---

## ДИАГНОСТИКА ПРОБЛЕМ

### **Проблема 1: missingCritical не пустой**

**Пример:**
```json
"missingCritical": ["τ"]
```

**Что это значит:**
- Composer не нашёл агента для функтора τ (Past)
- Это **критично**: без проверки истории будут дубли в outreach

**Что делать:**
1. Добавить агента с `c4Functor: "τ", modality: "Past"`
2. Или: согласиться с риском (если клиенты новые, история не нужна)

---

### **Проблема 2: redundant не пустой**

**Пример:**
```json
"redundant": ["τ"]
```

**Что это значит:**
- Два агента делают одно и то же (оба τ Present)
- Это **waste**: платите за токены дважды, конфликты возможны

**Что делать:**
1. Удалить одного из агентов
2. Или: дифференцировать через φ (контекст)
 - Agent_A: τ Present + φ (LinkedIn)
 - Agent_B: τ Present + φ (Email databases)

---

### **Проблема 3: sequenceWarnings есть**

**Пример:**
```json
"sequenceWarnings": ["Edge 3→1: τ Future before τ Past (unnatural flow)"]
```

**Что это значит:**
- Composer создал workflow, где планирование идёт ПЕРЕД анализом истории
- Это **логически неверно** (нельзя планировать, не зная прошлого)

**Что делать:**
1. Пересортировать edges (поменять sequence)
2. Или: если это намеренно, добавить комментарий "WHY"

---

### **Проблема 4: coveragePercent слишком низкий для задачи**

**Пример:**
```
Task: "Построить стратегию компании"
coveragePercent: 11% (только τ, δ, σ)
```

**Что это значит:**
- Задача сложная, но покрытие минимальное
- Скорее всего, **пропущены важные аспекты**

**Что делать:**
1. Добавить функторы:
 - ρ (паттерны в индустрии)
 - λ (абстракция принципов)
 - ι (альтернативные стратегии)
 - μ (рефлексия процесса)
2. Пересмотреть задачу: может, она проще, чем казалось?

---

## ПРАКТИЧЕСКИЕ СЦЕНАРИИ

### **Сценарий 1: "Не хватает агента"**

**Ситуация:**
```
Composer вернул:
 "missingCritical": ["ρ"]
 "analysisNotes": "Pattern detection needed but no agent available"
```

**Решение:**

**Вариант A: Создать нового агента**
```javascript
const newAgent = {
 address: "pattern_detector@domain",
 name: "Pattern Detector",
 c4Functor: "ρ",
 description: "Detects conversion patterns in lead data"
}
```

**Вариант B: Использовать существующего с добавкой**
```javascript
// Есть "data_analyzer@domain" (δ)
// Можем добавить ему ρ через композицию
{
 address: "data_analyzer@domain",
 c4Functor: "δ∘ρ", // теперь делает analysis + pattern detection
}
```

**Вариант C: Пропустить (если не критично)**
```
User: "Паттерны мне не нужны сейчас, пропускаем"
→ Composer пометит как missingOptional, продолжит
```

---

### **Сценарий 2: "Два агента дублируют функцию"**

**Ситуация:**
```
Composer вернул:
 "redundant": ["τ"]
 "analysisNotes": "lead_scraper and contact_finder both do τ Present"
```

**Решение:**

**Вариант A: Объединить**
```javascript
// Удалить contact_finder, оставить только lead_scraper
// Обновить его промпт, чтобы делал оба действия
```

**Вариант B: Дифференцировать через контекст (φ)**
```javascript
{
 address: "lead_scraper@domain",
 c4Functor: "τ",
 c4Modality: "Present",
 c4Context: "LinkedIn" // ← специализация
}

{
 address: "contact_finder@domain",
 c4Functor: "τ",
 c4Modality: "Present",
 c4Context: "Email databases" // ← другая специализация
}
```

Теперь не дубли, а **параллельные источники**.

---

### **Сценарий 3: "Нужна композиция, но агента нет"**

**Ситуация:**
```
Task: "Прогнозировать лучшие источники лидов"
→ Нужно: τ∘ρ (temporal + pattern analysis)
→ Есть: τ agent и ρ agent по отдельности
→ Нет: dedicated τ∘ρ agent
```

**Решение: Chaining (цепочка агентов)**

```json
{
 "nodes": [
 {
 "id": "n1",
 "data": {"c4Functor": "τ", "text": "Analyze temporal trends in lead sources"}
 },
 {
 "id": "n2",
 "data": {"c4Functor": "ρ", "text": "Detect patterns in [[n1]] trends"}
 }
 ],
 "edges": [
 {
 "source": "n1",
 "target": "n2",
 "data": {
 "c4Composition": "τ∘ρ",
 "compositionNote": "Implemented via chaining: temporal → pattern"
 }
 }
 ]
}
```

**Результат:** композиция реализована через последовательность агентов.

---

### **Сценарий 4: "Coverage слишком высокий — оверкилл"**

**Ситуация:**
```
Task: "Отправить email 10 людям"
Composer создал: 15 агентов, coverage 55%
```

**Проблема:** Composer переусложнил (task простой, а система — нет).

**Решение:**

**Вариант A: Упростить запрос**
```
User: "Просто отправь email, без анализа и оптимизации"
→ Composer пересоздаст с 2-3 агентами
```

**Вариант B: Ограничить coverage**
```
User: "Максимум 5 агентов"
→ Composer выберет топ-5 критичных функторов
```

**Вариант C: Указать явно**
```
User: "Нужны только: τ Present (сбор) и σ (отправка)"
→ Composer создаст минимальную систему
```

---

## НАСТРОЙКА ПОД СЕБЯ

### **Как добавить свой функтор (custom)**

**Пример:** Хотите добавить функтор "Ψ" (Creativity) для генерации креативных идей.

**Шаг 1: Обновить список функторов**
```javascript
// В 27_functor_agents_system_prompts.md добавить:

### 28. Ψ — КРЕАТИВНОСТЬ (Creativity Agent)
**Роль:** Генератор нестандартных идей
**Функция:** Создаю неожиданные решения, ломаю шаблоны
**Ответ:** `[Ψ]: идея: ... | новизна: 0-1 | применимость: ...`
```

**Шаг 2: Обновить Composer промпт**
```markdown
## COMPLETE 28-FUNCTOR REFERENCE (вместо 27)

#### **28. Ψ — CREATIVITY (Creativity Agent)**
- **Role:** Idea Generator
- **Function:** Creates unexpected solutions, breaks patterns
- **Use when:** Need creative breakthrough, challenge status quo
- **Examples:** "Brainstorm unconventional marketing", "Invent new product"
```

**Шаг 3: Создать агента**
```javascript
{
 address: "creative_engine@domain",
 name: "Creative Engine",
 c4Functor: "Ψ",
 description: "Generates unconventional ideas"
}
```

**Результат:** теперь Composer будет использовать Ψ для креативных задач.

---

### **Как создать свою композицию**

**Пример:** Хотите композицию "Ψ∘λ" (Creative Abstraction) — креатив + обобщение.

**Шаг 1: Определить смысл**
```
Ψ∘λ = сначала генерируем креативные идеи (Ψ),
 затем извлекаем из них общий принцип (λ)

Use case: "Придумай 10 идей продвижения → выдели паттерн"
```

**Шаг 2: Добавить в Composer**
```markdown
#### **29. Ψ∘λ — CREATIVE ABSTRACTION**
- **Role:** Pattern Extractor from Brainstorm
- **Function:** Generates many ideas, then finds common thread
- **Use when:** Need creative strategy, not just tactics
- **Examples:** "Innovate marketing approach", "Design new business model"
```

**Шаг 3: Использовать**
```
User: "Придумай стратегию продвижения"
Composer: "Detected need for Ψ∘λ composition"
→ Создаст: Creative Engine → Abstractor
```

---

## МЕТРИКИ ЭФФЕКТИВНОСТИ

### **Как оценить, работает ли C4-Composer**

**Метрика 1: Coverage Accuracy (точность покрытия)**
```
Для 10 тестовых задач:
 - Composer определил нужные функторы
 - Эксперт проверил: всё ли покрыто?

Target: ≥90% accuracy (9/10 задач покрыты корректно)
```

**Метрика 2: Redundancy Rate (процент дублей)**
```
Из 100 созданных Map:
 - Сколько содержали redundant agents?

Target: ≤5% (max 5 Map из 100)
```

**Метрика 3: Time to Team (время создания команды)**
```
До C4: 2-4 часа ручного подбора
После C4: 10-30 секунд автогенерации

Target: ≤60 секунд для 90% задач
```

**Метрика 4: Team Quality (качество команды)**
```
A/B test:
 - Группа A: команды без C4 (ручной подбор)
 - Группа B: команды с C4 (автогенерация)

Оценка:
 - Сколько задач завершено успешно?
 - Сколько провалов из-за пробелов в команде?

Target: Group B ≥ Group A по success rate
```

---

## ОБУЧАЮЩИЕ ПРИМЕРЫ

### **Пример A: Рекрутинг**

**Задача:**
```
"Создай систему для найма разработчиков: от поиска до оффера"
```

**C4 Analysis (пошагово):**

1. **Поиск кандидатов** → τ Present (собрать резюме)
2. **Скрининг** → δ (отсеять неподходящих)
3. **Анализ опыта** → τ Past (посмотреть, где работал)
4. **Техническое интервью** → λ (оценить уровень абстракции)
5. **Культурное соответствие** → ρ (сравнить с успешными сотрудниками)
6. **Оффер** → τ Future (условия будущей работы)
7. **Интеграция данных** → σ (собрать оценки в единую карточку)

**Функторы:** 7
**Coverage:** 26%
**Команда:** 7 агентов

**Map:**
```
[Sourcer] → [Screener] → [Experience_Analyzer] → [Tech_Interviewer] → [Culture_Checker] → [Offer_Crafter] → [Data_Integrator]
 τ° δ τ⁻ λ ρ τ⁺ σ
```

---

### **Пример B: Customer Support**

**Задача:**
```
"Автоматизируй поддержку: обработка тикетов + обучение на ошибках"
```

**C4 Analysis:**

1. **Приём тикета** → τ Present
2. **Классификация** → δ (простой/сложный/эскалация)
3. **Поиск похожих** → ρ (паттерн-матчинг с прошлыми тикетами)
4. **Генерация ответа** → κ (конкретный ответ для этого случая)
5. **Адаптация тона** → φ (friendly для B2C, formal для B2B)
6. **Обучение** → μ (что сработало? что нет?)
7. **Обновление KB** → λ∘σ (обобщить решение + добавить в базу знаний)

**Функторы:** 8 (7 базовых + 1 композиция)
**Coverage:** 30%
**Команда:** 8 агентов

**Map:**
```
Main flow:
 [Intake] → [Classifier] → [Pattern_Matcher] → [Answer_Generator] → [Tone_Adapter] → [Sender]
 τ° δ ρ κ φ

Learning loop:
 [Feedback_Collector] → [Knowledge_Updater]
 μ λ∘σ
```

---

### **Пример C: Contradiction Resolution (ТРИЗ-кейс)**

**Задача:**
```
"Как увеличить скорость доставки без удорожания?"
```

**C4 Analysis:**

1. **История проблемы** → τ Past (когда началось? что пробовали?)
2. **Текущее состояние** → τ Present (факты: скорость X, стоимость Y)
3. **Разделение проблемы** → δ (скорость vs. стоимость = разные оси)
4. **Инверсия** → ι (что если НЕ везти товар, а производить на месте?)
5. **Абстракция** → λ (суть: не "доставка", а "доступность")
6. **Синтез** → σ∘ι (примирение противоречий через новую парадигму)
7. **Конкретизация** → κ (3D-печать, микро-склады, самовывоз)
8. **Адаптация** → φ (разные решения для разных сегментов)

**Функторы:** 8 (6 базовых + 2 композиции: σ∘ι, λ∘σ)
**Coverage:** 30%
**Команда:** 6-7 агентов (некоторые композиции = chaining)

**Map:**
```
Analysis:
 [History] → [Current_State] → [Decomposer]
 τ⁻ τ° δ

Innovation:
 [Invertor] → [Abstractor] → [Dialectician]
 ι λ σ∘ι

Implementation:
 [Concretizer] → [Adapter]
 κ φ
```

---

## БЫСТРЫЙ СТАРТ (для твоего друга)

### **День 1: Минимальная интеграция**

**Что сделать:**
1. Обновить промпт Composer → `metaagent_composer_v2_c4.md`
2. Добавить к 5 существующим агентам поле `c4Functor`:
 ```javascript
 {
 address: "my_agent@domain",
 c4Functor: "τ", // ← добавить это
 c4Modality: "Present" // ← и это, если τ
 }
 ```
3. Протестировать: создать 1 Map, проверить, заполнилось ли `c4Coverage`

**Критерий успеха:** Composer возвращает JSON с полем `c4Coverage`.

---

### **День 2-3: Визуализация**

**Что сделать:**
1. Создать компонент `<C4Badge>` для функторов:
 ```jsx
 <C4Badge functor="τ" modality="Past" />
 // Отображается как: [τ⁻] с тултипом "Temporal: Past"
 ```
2. Показать в UI список функторов для каждого Map:
 ```
 Functors used: [τ⁻] [τ°] [δ] [σ]
 Coverage: 15% (4/27)
 ```

**Критерий успеха:** Пользователь видит, какие функторы использованы.

---

### **День 4-7: Coverage Dashboard**

**Что сделать:**
1. Панель "C4 Analysis" в Map Editor
2. Показать:
 - Coverage % (круговая диаграмма)
 - Список функторов (зелёные = покрыты, серые = нет)
 - Warnings (если есть gaps/redundancy)
3. Клик на функтор → highlight соответствующего агента

**Критерий успеха:** Пользователь кликает на "τ" → подсвечивается history_checker agent.

---

## РЕСУРСЫ

**Файлы в проекте:**
- `metaagent_composer_v2_c4.md` — промпт Composer (MAIN)
- `27_functor_agents_system_prompts.md` — описание всех 27 функторов
- `C4_INTEGRATION_GUIDE.md` — техническая документация
- `HOW_IT_WORKS_GUIDE.md` — этот файл (практический гайд)

**Научная база:**
- `../../preprint/C4-PREPRINT-V3-FINAL.md`
 - 11 формально доказанных теорем
 - Математическое обоснование 27 функторов

**Поддержка:**
- GitHub Issues (если открытый проект)
- Email: c4-cognitive@proton.me

---

## FAQ

### Q: Нужно ли всегда 100% coverage?
**A:** Нет! Большинство задач — 15-40%. 100% нужно только для AGI-уровня задач.

### Q: Что если Composer ошибается в выборе функторов?
**A:** Можно явно указать: `"Use functors: τ, δ, σ only"`. Composer подчинится.

### Q: Можно ли использовать C4 без LLM?
**A:** Да! C4 — это просто структура. Можно вручную размечать агентов и проверять coverage.

### Q: Как быстро пользователи поймут C4?
**A:** Базовые концепции (τ, δ, σ) — за 5 минут. Полное понимание 27 функторов — за 1-2 недели использования.

### Q: Обязательно ли знать математику C4?
**A:** Нет. Для пользователей: просто "функторы = когнитивные операции". Математика — под капотом.

---

**КОНЕЦ ГАЙДА. ТЕПЕРЬ ВЫ ЗНАЕТЕ, КАК ЭТО РАБОТАЕТ! **
